# Implementing an API Gateway

- The primary responsibilities of API Gateway should include the following.
  - Request routing
  - API composition
  - Edge functions
  - Protocol translations
  - Should support service discovery, observability patterns.
- API gateway can implemented with any of the below approaches.
  - `Using an off-the-shelf API gateway product/service`
  - `Developing your own API gateway using either an API gateway framework or a web framework as the starting point`

## _Using an off-the-shelf API gateway product/service_

### _AWS API GATEWAY_

- An AWS API gateway API is a set of REST resources, each of which supports one or more HTTP methods.
- Using AWS API gateway we can configure to route each (Method, Resource) to a backend service.
- Using AWS API gateway we can transform request and response using a template-based mechanism.
- The AWS API gateway can also authenticate requests.
- `Limitations`
  - It does not support API composition.
  - It only supports HTTP(S) with a heavy emphasis on JSON.   
  - It only supports the Server-side discovery pattern through a load balancer.
- Unless API composition is needed, the AWS API gateway is a good implementation of the API gateway pattern.

### _AWS APPLICATION LOAD BALANCER_

- AWS APPLICATION LOAD BALANCER service provides API gateway-like functionality.
- This works with HTTP, HTTPS, WebSocket, and HTTP/2.
- We can define routing rules that route requests to backend services, which must be running on AWS EC2 instances.
- It implements basic routing functionality.
- `Limitations`
  - It does not implement HTTP method-based routing.
  - It does not implement API composition or authentication.  

### _USING AN API GATEWAY PRODUCT_

- The modern popular API gateway product choices are Kong or Traefik.
- Kong is based on NGINX HTTP server, whereas Traefik is written in GoLang.
- Both products are configured using flexible routing rules that use the HTTP method, headers, and path to select the 
  backend service.
- Both supports plugins for the edge functions such as authentication.
- `Traefik` can integrate with some service registries.
- `Limitations`
  - Need to install, configure, and operate.
  - These products do not implement API composition.

## _Developing own API gateway_

- An API gateway is a web application that proxies requests to other services.
- An API gateway needs to solve two key design problems.
  - Implementing a mechanism for defining routing rules in order to minimize the complex coding.
  - Correctly implementing the HTTP proxying behavior, including how HTTP headers are handled.
- An API gateway can be implemented using a framework designed for that purpose.    
  - Netflix Zuul
  - Spring cloud gateway
    
### _NETFLIX ZUUL_

- Netflix developed the Zuul framework to implement edge functions such as routing, rate limiting, and authentication.
- The Zuul framework uses the concept of filters.
  - These filters are reusable request interceptors that are similar to servlet filters or NodeJS Express middleware.
- Zuul handles a http request by assembling a chain of filters, that transform the request/response when invoking backends.
- Spring Cloud Zuul builds on Zuul and through convention-over-configuration makes developing a Zuul-based easy.
- We can extend Zuul by defining Spring MVC controllers that implement API composition.
- `Limitations`
  - It supports only path based routing.
    - For ex, it’s incapable of routing GET /orders to one service and POST /orders to a different service.

### _SPRING CLOUD GATEWAY_

- It’s an API gateway framework built on top of several frameworks.
  - Spring 5
  - Spring boot 2
  - Spring webflux(Reactive web framework that is part of spring 5 built using project reactor)
- Project Reactor is an NIO-based reactive framework for the JVM that provides the Mono abstraction.
- Spring Cloud Gateway provides a simple yet comprehensive way to implement 
  - Route requests to backend services
  - Api composition
  - Edge function

    
  